/* ==================== RTL SUPPORT FOR ARABIC ==================== */

/* RTL support for text direction */
[dir="rtl"] {
    direction: rtl;
    text-align: right;
}

[dir="rtl"] * {
    font-family: 'Inter', 'Noto Sans Arabic', 'Segoe UI', Tahoma, Arial, sans-serif;
}

/* RTL-specific text alignment for Arabic content (excluding centered modal titles) */
.rtl .toolbar-label,
.rtl .modal-title,
.rtl .modal-subtitle,
.rtl .form-group label,
.rtl .tool-name,
.rtl .tool-desc,
.rtl .option-title,
.rtl .option-desc {
    text-align: right;
}

/* Keep modal h2 and h3 titles perfectly centered in both languages */
.rtl .modal h2,
.rtl .modal h3 {
    text-align: center !important;
    margin-left: auto !important;
    margin-right: auto !important;
    display: block !important;
}

/* Keep modal icon and subtitle centered in both languages with proper line height */
.rtl .modal .modal-icon,
.rtl .modal .modal-subtitle {
    text-align: center !important;
    display: block !important;
    margin-left: auto !important;
    margin-right: auto !important;
}

/* Reset confirmation dialog RTL support with enhanced text alignment */
.rtl #reset-confirm-modal .modal-icon,
.rtl #reset-confirm-modal .modal-subtitle,
.rtl #reset-confirm-modal h3 {
    text-align: center !important;
    margin-left: auto !important;
    margin-right: auto !important;
}

/* Ensure reset confirmation subtitle text is perfectly aligned line by line */
.rtl #reset-confirm-modal .modal-subtitle {
    line-height: 1.6 !important;
    text-align: center !important;
    direction: rtl;
    unicode-bidi: embed;
}

/* Ensure modal subtitles have consistent line spacing in RTL */
.rtl .modal .modal-subtitle {
    line-height: 1.6 !important;
}

/* Keep layout elements consistent while allowing text to be RTL */
.rtl .modal-content,
.rtl .form-group,
.rtl .modal-actions,
.rtl .reset-option-btn {
    direction: rtl;
}

/* Bottom toolbar buttons should maintain consistent sizing and layout in RTL */
.rtl .toolbar-btn {
    direction: ltr;
    /* Keep toolbar buttons layout consistent */
}

/* Keep SVG icons aligned correctly */
.rtl .toolbar-btn svg {
    margin-right: 0;
    margin-left: 0;
}

.rtl .modal-content svg:not(.btn-close-modal svg):not(.btn-close-panel svg) {
    margin-right: 0;
    margin-left: var(--space-2);
}

/* Form inputs should maintain proper direction */
.rtl input[type="text"],
.rtl input[type="email"],
.rtl input[type="tel"],
.rtl textarea {
    text-align: left;
    direction: ltr;
    /* Keep input values in their natural direction */
}

/* Modal actions button alignment */
.rtl .modal-actions {
    justify-content: flex-start;
}

/* Keep modal action buttons perfectly aligned in both languages */
.rtl .modal-actions .btn-primary,
.rtl .modal-actions .btn-secondary {
    margin-left: 0;
    margin-right: 0;
}

/* Keep the overall UI layout the same, only text direction changes */
.rtl .header-info,
.rtl #header,
.rtl .bottom-toolbar,
.rtl .canvas-zoom-controls {
    direction: ltr;
    /* Keep UI elements in LTR for layout consistency */
}

/* Screen reader only text */
.sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border: 0;
}

/* Button text styling */
.btn-text {
    margin-left: var(--space-2);
    font-size: inherit;
    font-weight: inherit;
}

/* Hide screen reader text in normal view, show for RTL */
.rtl .btn-close-panel .sr-only,
.rtl .btn-close-modal .sr-only {
    position: static;
    width: auto;
    height: auto;
    padding: 0;
    margin: 0;
    overflow: visible;
    clip: auto;
    white-space: normal;
}

/* Ensure panel headers work correctly in RTL */
.rtl .panel-header {
    flex-direction: row-reverse;
}

/* Ensure close buttons are perfectly centered in both LTR and RTL */
.btn-close-panel,
.btn-close-modal {
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

/* Ensure all close buttons are perfectly centered */
.btn-close-panel,
.btn-close-modal {
    display: flex;
    align-items: center;
    justify-content: center;
}

.btn-close-panel svg,
.btn-close-modal svg {
    display: block;
    width: 16px;
    height: 16px;
    flex-shrink: 0;
    min-width: 16px;
    min-height: 16px;
}

/* Ensure close button SVGs have no margin in RTL mode */
.rtl .btn-close-modal svg,
.rtl .btn-close-panel svg {
    margin-right: 0;
    margin-left: 0;
}

/* Fix close button alignment in RTL - ensure click area matches visual with higher specificity */
.rtl .modal .btn-close-modal {
    box-sizing: border-box !important;
    padding: 8px !important;
    margin: 0 !important;
    line-height: 1 !important;
    /* Explicit dimensions to ensure perfect click area */
    width: 32px !important;
    height: 32px !important;
}

/* Ensure SVG is perfectly centered in RTL close buttons with higher specificity */
.rtl .modal .btn-close-modal svg {
    display: block !important;
    width: 16px !important;
    height: 16px !important;
    margin: 0 !important;
    padding: 0 !important;
    line-height: 1 !important;
    flex-shrink: 0 !important;
}

/* ==================== MODALS ==================== */

/* Fix RTL modal header - use margins instead of absolute positioning */
.rtl .modal-compact {
    /* Keep natural document flow - no position changes */
}

.rtl .modal-compact h3 {
    /* Perfect centering - override any positioning that breaks centering */
    margin-top: 0;
    margin-bottom: var(--space-6) !important;
    /* Force spacing in RTL */
    text-align: center !important;
    /* Force centering for both languages */
    line-height: 1.2;
    margin-left: auto !important;
    margin-right: auto !important;
    display: block !important;
    width: 100%;
    /* Ensure full width for proper centering */
}

/* Specific RTL rule for reset menu title spacing - override any conflicting rules */
.rtl #reset-menu h3 {
    margin-bottom: var(--space-6) !important;
    text-align: center !important;
    margin-left: auto !important;
    margin-right: auto !important;
    display: block !important;
    width: 100% !important;
}

/* Handle Saved Action Buttons in RTL - make import button text even smaller */
.rtl .saved-actions .btn-text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: clip;
    /* Use clip instead of ellipsis for Arabic */
    text-align: center;
    line-height: 1.2;
    /* Standard font size for most buttons */
    font-size: 12px;
}

/* Specifically make import button (2nd child) smaller */
.rtl .saved-action-btn:nth-child(2) .btn-text {
    font-size: 10px;
    /* Much smaller for 'استيراد' */
}

.rtl .saved-action-btn {
    min-height: 48px;
    /* Keep same height as English mode */
}

/* ==================== PERFECT CENTERING OVERRIDES ==================== */

/* Force perfect centering for all modal titles regardless of other rules */
.rtl .modal h2,
.rtl .modal h3 {
    text-align: center !important;
    margin: 0 auto !important;
    display: block !important;
    width: 100% !important;
    position: relative !important;
    float: none !important;
    clear: both !important;
}

/* Perfect line alignment for reset confirmation dialog text */
.rtl #reset-confirm-modal .modal-subtitle {
    text-align: center !important;
    line-height: 1.8 !important;
    direction: rtl !important;
    unicode-bidi: embed !important;
    white-space: normal !important;
}

/* Fix import confirmation dialog close button positioning in RTL */
.rtl #import-confirm-modal {
    direction: ltr;
    /* Keep container LTR to prevent positioning issues */
}

.rtl #import-confirm-modal .modal-content {
    direction: rtl;
    /* Only text content is RTL */
}

.rtl #import-confirm-modal .btn-close-modal {
    /* Force top-left positioning in RTL with no offset */
    position: absolute !important;
    top: var(--space-4) !important;
    left: var(--space-4) !important;
    right: auto !important;
    width: 32px !important;
    height: 32px !important;
    box-sizing: border-box !important;
    padding: 8px !important;
    margin: 0 !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    transform: none !important;
    vertical-align: top !important;
}

.rtl #import-confirm-modal .btn-close-modal svg {
    width: 16px !important;
    height: 16px !important;
    display: block !important;
    margin: 0 !important;
    padding: 0 !important;
    flex-shrink: 0 !important;
}

/* RTL flexbox close button positioning - general rule moves to left */
.rtl .modal-header-flex {
    justify-content: flex-start !important;
}

/* EXCEPTION: Saved modal stays on the right even in Arabic */
.rtl #saved-modal .modal-header-flex {
    justify-content: flex-end !important;
    display: flex !important;
    flex-direction: row !important;
}

/* Force the close button inside saved modal to stay on right */
.rtl #saved-modal .modal-header-flex .btn-close-modal-flex {
    margin-left: auto !important;
    margin-right: 0 !important;
    align-self: flex-start !important;
}

/* Alternative approach: absolute positioning as backup */
.rtl #saved-modal .modal-content .modal-header-flex {
    position: relative !important;
}

.rtl #saved-modal .modal-content .modal-header-flex .btn-close-modal-flex {
    position: absolute !important;
    top: var(--space-4) !important;
    right: var(--space-4) !important;
    left: auto !important;
    margin: 0 !important;
}

/* Force close button to stay on the right for saved modal in Arabic mode */
.rtl #saved-modal .btn-close-modal-flex {
    margin-left: auto !important;
    margin-right: 0 !important;
}

/* NEW: RTL positioning for the actual saved modal structure (JavaScript-generated) */
.rtl #saved-modal .saved-modal-header .btn-close-modal {
    left: auto !important;
    right: var(--space-4) !important;
    top: var(--space-4) !important;
}